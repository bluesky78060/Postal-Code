/* A4 라벨 출력용 CSS - 2열 9행 (18개) 기준 */

@media print {
    @page {
        size: A4;
        margin: 0;
    }

    * {
        -webkit-print-color-adjust: exact !important;
        color-adjust: exact !important;
        print-color-adjust: exact !important;
    }

    body {
        font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', 'Segoe UI', sans-serif;
        margin: 0 !important;
        padding: 0 !important;
        background: white !important;
    }

    /* 프린트 시: 모달 내용만 출력 */
    .container { display: none !important; }
    nav, header, footer { display: none !important; }
    .tabs, .tab, .file-upload { display: none !important; }
    #upload, #search, #labelDataPreview, #labelUploadProgress, #uploadResult, #searchResult { display: none !important; }

    /* 모달을 전체 페이지용으로 표시 */
    #labelModal { 
        display: block !important; 
        position: static !important; 
        background: transparent !important; 
        padding: 0 !important;
    }
    #labelModalContent, #labelModal .modal-content {
        box-shadow: none !important;
        border: none !important;
        width: auto !important;
        max-height: none !important;
        border-radius: 0 !important;
    }
    #labelModal .modal-header { display: none !important; }
    #labelModal .modal-body { padding: 0 !important; background: transparent !important; }
}

/* A4 라벨 시트 - 2열 9행 */
.label-sheet-2x9 {
    width: 210mm;
    height: 297mm;
    padding: 8.5mm 5mm;
    margin: 0;
    display: grid;
    grid-template-columns: repeat(2, 100mm);
    grid-template-rows: repeat(9, 30mm);
    gap: 0;
    background: white;
    page-break-after: always;
    justify-content: center;
}

/* 개별 라벨 스타일 */
.label-item {
    width: 100mm;
    height: 30mm;
    border: 0.5px solid #e0e0e0;
    padding: 3mm;
    /* 셀 안 좌우 여백: 기존 + 3px 추가 */
    padding-left: calc(3pt + 3px);
    padding-right: calc(3pt + 3px);
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    justify-content: center;
    font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif;
    font-size: 11pt;
    line-height: 1.3;
    overflow: hidden;
    position: relative;
}

/* 테이블 기반 라벨 배치 */
.label-item .label-table {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
}
.label-item .label-table td {
    padding: 0.5mm 0.8mm;
    vertical-align: middle;
}

/* 1행: 이름 + 주소 */
.label-item .cell-name {
    font-size: 13pt;
    font-weight: bold;
    color: #2c3e50;
    letter-spacing: 0.5px;
    text-align: left;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}
.label-item .cell-address {
    font-size: 12pt;
    color: #2c3e50;
    letter-spacing: 0.5px;
    text-align: left;
    overflow-wrap: break-word;
}

/* 2행: 상세주소 + 우편번호 */
.label-item .cell-detail {
    font-size: 12pt;
    color: #34495e;
    letter-spacing: 0.5px;
    text-align: left;
    overflow-wrap: break-word;
}
.label-item .cell-postal {
    font-size: 12pt;
    color: #2c3e50;
    letter-spacing: 1.2px;
    text-align: right;
    white-space: nowrap;
}

/* 3행(옵션): 호칭 단독 라인 */
.label-item .cell-suffix {
    font-size: 11pt;
    color: #2c3e50;
    text-align: left;
    padding-top: 0.6mm;
}

/* 주소 스타일 (첫 번째) */
.label-address {
    font-size: 12pt;
    color: #2c3e50;
    line-height: 1.3;
    margin-bottom: 1.5mm;
    word-wrap: break-word;
    overflow-wrap: break-word;
    text-align: left;
    letter-spacing: 0.5px;
}

/* 상세주소 (주소 아래 한 줄) */
.label-detail {
    font-size: 12pt;
    color: #34495e;
    line-height: 1.3;
    margin-top: 0;
    margin-bottom: 2mm;
    text-align: left;
    word-wrap: break-word;
    overflow-wrap: break-word;
    letter-spacing: 0.5px;
}

/* 수신인 이름 스타일 (두 번째) */
.label-name {
    font-size: 13pt;
    font-weight: bold;
    color: #2c3e50;
    text-align: left;
    letter-spacing: 0.5px;
    margin-top: 1.2mm;
    margin-bottom: 0.8mm;
}

/* 우편번호 스타일 (세 번째) */
.label-postal-code {
    font-size: 12pt;
    font-weight: normal;
    color: #2c3e50;
    text-align: right;
    letter-spacing: 1.5px;
    margin-top: 0.5mm;
}

/* 기타 정보 스타일 */
.label-extra {
    font-size: 9pt;
    color: #7f8c8d;
    text-align: right;
    position: absolute;
    bottom: 2mm;
    right: 3mm;
}

/* 화면 미리보기용 스타일 */
.label-preview {
    transform: scale(0.6);
    transform-origin: top left;
    margin-bottom: 20px;
    border: 1px solid #ccc;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

/* 3열 7행 라벨 (21개) */
.label-sheet-3x7 {
    width: 210mm;
    height: 297mm;
    padding: 8mm 5mm;
    margin: 0;
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    grid-template-rows: repeat(7, 1fr);
    gap: 0;
    background: white;
    page-break-after: always;
}

.label-sheet-3x7 .label-item {
    width: 64mm;
    height: 38mm;
}

/* 4열 6행 라벨 (24개) */
.label-sheet-4x6 {
    width: 210mm;
    height: 297mm;
    padding: 8mm 5mm;
    margin: 0;
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    grid-template-rows: repeat(6, 1fr);
    gap: 0;
    background: white;
    page-break-after: always;
}

.label-sheet-4x6 .label-item {
    width: 47mm;
    height: 43mm;
}

/* 라벨 내용이 긴 경우 처리 */
.label-item.long-content .cell-name,
.label-item.long-content .cell-address {
    font-size: 11pt;
}
.label-item.long-content .cell-detail {
    font-size: 11pt;
    line-height: 1.2;
}
.label-item.long-content .cell-postal {
    font-size: 11pt;
}

/* 빈 라벨 스타일 */
.label-item.empty {
    border-style: dashed;
    border-color: #bdc3c7;
    background: #fafafa;
}

/* 프린트 시 페이지 설정 */
@media print {
    .label-sheet-2x9,
    .label-sheet-3x7,
    .label-sheet-4x6 {
        transform: none !important;
        margin: 0 !important;
        box-shadow: none !important;
        border: none !important;
    }

    .label-item {
        border-color: #333 !important;
        -webkit-print-color-adjust: exact;
    }
}
